server.port=${PORT:8080}
spring.application.name=GreenLoop

# Database Configuration
# Handle Railway DATABASE_URL format (postgresql://) vs Spring Boot format (jdbc:postgresql://)
spring.datasource.url=${SPRING_DATASOURCE_URL:${DATABASE_URL:jdbc:postgresql://localhost:5432/greenLoop}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${DB_USERNAME:postgres}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD:Linhvovip}}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.main.allow-circular-references=true

# Email Configuration
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:greenloopcyc@gmail.com}
spring.mail.password=${MAIL_PASSWORD:mubkcunbpryolcpj}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Cloudinary Configuration
cloudinary.cloud_name=${CLOUDINARY_CLOUD_NAME:dmpjc496u}
cloudinary.api_key=${CLOUDINARY_API_KEY:867162548936863}
cloudinary.api_secret=${CLOUDINARY_API_SECRET:t_Wp6_Yoc8xLv0nXXfqO-gIVF8I}

# Swagger Configuration
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/v3/api-docs

# JWT Configuration
app.jwtSecret=${JWT_SECRET:mySecretKey1234567890abcdefghijklmnopqrstuvwxyz}
app.jwtExpirationInMs=86400000

# Frontend URL Configuration
app.frontend.url=${FRONTEND_URL:http://localhost:3000}

# CORS Configuration
spring.web.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000}
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true

# Logging Configuration
logging.level.root=INFO
logging.level.org.greenloop.circularfashion=DEBUG
logging.level.org.springframework.security=DEBUG 

# Redis Configuration (disabled for now)
# spring.data.redis.host=${REDIS_HOST:localhost}
# spring.data.redis.port=${REDIS_PORT:6379}
# spring.data.redis.username=${REDIS_USERNAME:}
# spring.data.redis.password=${REDIS_PASSWORD:}
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration

# Firebase Configuration (disabled by default - enable if you have firebase-admin.json)
firebase.enabled=false
fcm.credentials.file.path=${FIREBASE_ADMIN:firebase-admin.json}

# Spring Boot Actuator Configuration (health disabled)
management.endpoints.web.exposure.include=info,metrics,prometheus,env,configprops
management.endpoint.health.enabled=false
management.metrics.export.prometheus.enabled=true
management.metrics.tags.application=greenloop-backend
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles.http.server.requests=0.5,0.95,0.99
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
management.metrics.enable.logback=true
management.metrics.enable.tomcat=true
management.metrics.enable.hikaricp=true

# Startup Configuration - Optimized for Railway
spring.main.lazy-initialization=true
spring.jpa.open-in-view=false
spring.jpa.defer-datasource-initialization=false
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false

# Data source pool optimization for faster startup
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.connection-timeout=20000

# Health Check Configuration - Optimized for Railway
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true
management.health.defaults.enabled=true
management.health.db.enabled=true
management.health.diskspace.enabled=false
management.health.ping.enabled=true
management.endpoint.health.enabled=true
management.endpoint.health.show-details=always

# Debug health check issues
logging.level.org.springframework.boot.actuate.health=DEBUG
logging.level.org.springframework.boot.actuate=DEBUG

# Logging Configuration for Startup
logging.level.org.springframework.boot=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN 